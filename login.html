<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Simantap Mod</title>
    <link rel="icon" type="image/x-icon" href="red-hat.ico">
    <link href="./asasdmmek.min.css" rel="stylesheet">
    <style>
      .loading-container {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background-color: rgba(0, 0, 0, 0.5);
        display: flex;
        justify-content: center;
        align-items: center;
        z-index: 9999;
        opacity: 0;
        visibility: hidden;
        transition: opacity 0.3s, visibility 0.3s;
      }
  
      .loading-container.show {
        opacity: 1;
        visibility: visible;
      }
  
      .loading-spinner {
        border: 4px solid #f3f3f3;
        border-top: 4px solid #3498db;
        border-radius: 50%;
        width: 30px;
        height: 30px;
        animation: spin 2s linear infinite;
      }
  
      @keyframes spin {
        0% { transform: rotate(0deg); }
        100% { transform: rotate(360deg); }
      }
    </style>
</head>
<body class="font-sans antialiased bg-dots">
    <div class="flex min-h-full flex-col justify-center px-6 py-12 lg:px-8">
        <div class="sm:mx-auto sm:w-full sm:max-w-sm">
          <img class="mx-auto h-10 w-auto" src="https://cdn.worldvectorlogo.com/logos/red-hat.svg" alt="Your Company">
          <h2 class="mt-10 text-center text-2xl/9 font-bold tracking-tight text-gray-900">Silahkan login dengan akun SIMANTAP</h2>
        </div>

        <!-- informasi loading login -->
      
        <div class="mt-10 sm:mx-auto sm:w-full sm:max-w-sm">
          <form class="space-y-6" id="loginForm">
            <div>
              <label class="block text-sm/6 font-medium text-gray-900">Username / Email</label>
              <label for="nim" class="input input-bordered flex items-center gap-2">
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  viewBox="0 0 16 16"
                  fill="currentColor"
                  class="h-4 w-4 opacity-70">
                  <path
                    d="M8 8a3 3 0 1 0 0-6 3 3 0 0 0 0 6ZM12.735 14c.618 0 1.093-.561.872-1.139a6.002 6.002 0 0 0-11.215 0c-.22.578.254 1.139.872 1.139h9.47Z" />
                </svg>
                <input type="text" id="nim" name="identity" class="grow" placeholder="Username" required/>
              </label>
            </div>
      
            <div>
              <div class="flex items-center justify-between">
                <label for="password" class="block text-sm/6 font-medium text-gray-900">Password</label>
              </div>
              <label for="password" class="input input-bordered flex items-center gap-2">
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  viewBox="0 0 16 16"
                  fill="currentColor"
                  class="h-4 w-4 opacity-70">
                  <path
                    fill-rule="evenodd"
                    d="M14 6a4 4 0 0 1-4.899 3.899l-1.955 1.955a.5.5 0 0 1-.353.146H5v1.5a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1-.5-.5v-2.293a.5.5 0 0 1 .146-.353l3.955-3.955A4 4 0 1 1 14 6Zm-4-2a.75.75 0 0 0 0 1.5.5.5 0 0 1 .5.5.75.75 0 0 0 1.5 0 2 2 0 0 0-2-2Z"
                    clip-rule="evenodd" />
                </svg>
                <input type="password" id="password" name="password" class="grow" placeholder="Password" required/>
              </label>
            </div>
      
            <div>
              <button type="submit" class="flex w-full justify-center rounded-md bg-indigo-600 px-3 py-1.5 text-sm/6 font-semibold text-white shadow-sm hover:bg-indigo-500 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-600">Login</button>
            </div>

            <div class="loading-container" id="loading-container">
              <div class="loading-spinner"></div>
            </div>
            
          </form>
          Langkah-langkah
          <div class="dropdown dropdown-center">
            <div tabindex="0" role="button" class="btn btn-circle btn-ghost btn-xs text-info">
              <svg
                tabindex="0"
                xmlns="http://www.w3.org/2000/svg"
                fill="none"
                viewBox="0 0 24 24"
                class="h-4 w-4 stroke-current">
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
              </svg>
            </div>
            <div
              tabindex="0"
              class="card compact dropdown-content bg-base-100 rounded-box z-[1] w-64 shadow">
              <div tabindex="" class="card-body">
                <h2 class="card-title">Yang harus dilakukan</h2>
                <ol type="1">
                  <li>1. Login terlebih dahulu ke website simantap</li>
                  <li>2. Setelah itu, kembali ke website ini, dan login kembali menggunakan akun simantap.</li>
                </ol>
              </div>
            </div>
          </div>
          <br><br>
          <div id="error" class="error"></div>
        </div>
      </div>
      <footer class="footer footer-center text-base-content p-4">
        <aside>
          <p id="copyright">
            Copyright © <span id="current-year"></span> - Created with ❤ - r0otk1t
          </p>
        </aside>
      </footer>
      <script src="js/dis.js"></script>
      <script>
        
document.getElementById('loginForm').addEventListener('submit', async (e) => {
    e.preventDefault();
    showLoading();

    const formData = {
        identity: document.getElementById('nim').value,
        password: document.getElementById('password').value,
        _token: 'dummy-token'
    };

    try {

      // 
         // cek apakah user sudah login pada simantap atau belum?
      // 
        const response = await fetch('https://voip.sbp.net.id:3000/proxy/login', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify(formData),
            credentials: 'include'
        });
        const data = await response.json();

        if (data.info === 'berhasil') {
            // Simpan data user ke localStorage untuk digunakan di dashboard
            localStorage.setItem('userInfo', JSON.stringify(data));
            window.location.href = './dashboard/main.html';
        } else {
            document.getElementById('error').className = 'alert alert-warning';
            document.getElementById('error').role = 'alert';
            document.getElementById('error').style.display = 'block';
            document.getElementById('error').textContent = 'Username atau password salah';
            hideLoading();
        }
    } catch (error) {
        document.getElementById('error').className = 'alert alert-error';
        document.getElementById('error').role = 'alert';
        document.getElementById('error').style.display = 'block';
        document.getElementById('error').textContent = 'Terjadi kesalahan saat login';
        hideLoading();
    }
});

function showLoading() {
    const loadingContainer = document.getElementById('loading-container');
    loadingContainer.classList.add('show');
}

function hideLoading() {
    const loadingContainer = document.getElementById('loading-container');
    loadingContainer.classList.remove('show');
}
    </script>
</body>
</html>

